@page "/User/create"

@rendermode InteractiveServer

@using Application.DTO
@using Application.Services.Users
@using System.ComponentModel.DataAnnotations
@inject IIdentityService IdentityService
@inject NavigationManager NavigationManager

<PageTitle>Create User</PageTitle>


   
  @* <a href="/Customers" class="btn btn-secondary">Back to List</a> *@
 <MudButton Href="/User" Variant="Variant.Filled" Color="Color.Secondary">Back to List</MudButton>
       
    <h3>Create User</h3>
<div class="container mt-4">
  <div class="row justify-content-center">

<EditForm Model="@Model" OnValidSubmit="OnvalidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary  class="alert alert-danger py-2 mb-3"/>

    @* <div class="row g-2 mb-2"> 
       <div class="col-md-6 ">
            <label for="FirstName" class="form-label"> Name</label>
            <InputText id="FirstName" class="form-control" @bind-Value="Model.Name" placeholder="Enter Name" />
            <ValidationMessage For="@(() => Model.Name)" class="text-danger"/>
       </div>
       <div class="col-md-6 ">
            <label for="Email" class="form-label"> Email</label>
            <InputText id="Email" class="form-control" @bind-Value="Model.Email" placeholder="Enter Email" />
            <ValidationMessage For="@(() => Model.Email)" class="text-danger"/>
       </div>
       <div class="col-md-6 ">
            <label for="PhoneNumber" class="form-label"> PhoneNumber</label>
            <InputText id="PhoneNumber" class="form-control" @bind-Value="Model.PhoneNumber" placeholder="Enter Phone Number" />
            <ValidationMessage For="@(() => Model.PhoneNumber)" class="text-danger"/>
       </div>
       <div class="col-md-6 ">
            <label for="Address" class="form-label"> Address</label>
            <InputText id="Address" class="form-control" @bind-Value="Model.Address" placeholder="Enter Address" />
            <ValidationMessage For="@(() => Model.Address)" class="text-danger"/>
       </div>
        <div class="col-md-6 ">
            <label for="City" class="form-label"> City</label>
            <InputText id="City" class="form-control" @bind-Value="Model.City" placeholder="Enter City" />
            <ValidationMessage For="@(() => Model.City)" class="text-danger"/>
       </div>
        <div class="col-md-6 ">
            <label for="Type" class="form-label"> Type</label>
            <InputText id="Type" class="form-control" @bind-Value="Model.Type" placeholder="Enter Type" />
            <ValidationMessage For="@(() => Model.Type)" class="text-danger"/>
       </div>
        <div class="col-md-6 ">
            <label for="CreatedBy" class="form-label"> CreatedBy</label>
            <InputText id="CreatedBy" class="form-control" @bind-Value="Model.CreatedBy" placeholder="Enter CreatedBy" />
            <ValidationMessage For="@(() => Model.CreatedBy)" class="text-danger"/>
       </div>
    <div> *@
    
   
        <MudGrid Spacing="3">
            <MudItem xs="12" sm="6">
                <MudTextField @bind-Value="Model.FirstName" Label="First Name" Required="true" Variant="Variant.Filled" />
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField @bind-Value="Model.LastName" Label="Last Name" Required="true" Variant="Variant.Filled" />
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField @bind-Value="Model.Email" Label="Email" Required="true" Variant="Variant.Filled" />
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField @bind-Value="Model.PhoneNumber" Label="Phone Number" Required="true" Variant="Variant.Filled" />
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField T="string" Label="Password" @bind-Value="Model.Password" Required="true" Variant="Variant.Filled">
                </MudTextField>
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField T="string" Label="ConfirmPassword" @bind-Value="Model.ConfirmPassword" Required="true" Variant="Variant.Filled"> 
                </MudTextField>
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField T="string" Label="EmailConfirmed" @bind-Value="Model.EmailConfirmed" Required="true" Variant="Variant.Filled">
                </MudTextField>
            </MudItem>
           
                  </MudGrid>

       @* <button type="submit" class="btn btn-primary mt-3">Create Customer</button> *@
      <MudButton Href="/User" Variant="Variant.Filled" Color="Color.Error">Cancel</MudButton>
       <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="OnvalidSubmit">Create User</MudButton>
 
    </EditForm>
    </div>  
    </div>
     

@code{
    private RegisterUserDTO Model { get;set; } =new();
    private async void OnvalidSubmit()
    {
        await IdentityService.RegisterUser(Model);
        NavigationManager.NavigateTo("/User");
    }
}