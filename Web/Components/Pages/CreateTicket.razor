
@page "/SupportTicket/Create"

@rendermode InteractiveServer

@using Application.DTO
@using Application.Services.Tickets
@using System.ComponentModel.DataAnnotations
@using MudBlazor
@inject ITicketService TicketService
@inject NavigationManager NavigationManager

<PageTitle>Create Ticket</PageTitle>


   
  @* <a href="/SupportTicket" class="btn btn-secondary">Back to List</a> *@
<MudButton Href="/SupportTicket"  Variant="Variant.Filled" Color="Color.Secondary">Back to List</MudButton>

    <h3>Create Ticket</h3>
<div class="container mt-4">
  <div class="row justify-content-center">

<EditForm Model="@Model" OnValidSubmit="OnvalidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary  class="alert alert-danger py-2 mb-3"/>

   
        <MudGrid Spacing="3">
            <MudItem xs="12" sm="6">
                <MudTextField @bind-Value="Model.CustomerId" Label="Customer ID" Required="true" Variant="Variant.Filled" />
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField @bind-Value="Model.Subject" Label="Subject" Required="true" Variant="Variant.Filled" />
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField @bind-Value="Model.Description" Label="Description" Required="true" Variant="Variant.Filled" Lines="3" />
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField T="string" Label="Status" @bind-Value="Model.Status" Required="true" Variant="Variant.Filled">
                </MudTextField>
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField T="string" Label="Priority" @bind-Value="Model.Priority" Required="true" Variant="Variant.Filled"> 
                </MudTextField>
            </MudItem>

            <MudItem xs="12" sm="6">
                <MudTextField T="string" Label="Type" @bind-Value="Model.Type" Required="true" Variant="Variant.Filled">
                </MudTextField>
            </MudItem>

            @* <MudItem xs="12" sm="6">
                <MudDatePicker @bind-Date="Model.ClosedAt" Label="Closed At" Variant="Variant.Filled" />
            </MudItem> *@
        </MudGrid>
  
       @* <button type="submit" class="btn btn-primary mt-3">Create Ticket</button>
       <a href="/SupportTicket" class="btn btn-link btn text-muted">Cancel</a> *@
       <MudButton Href="/SupportTicket" Variant="Variant.Filled" Color="Color.Error">Cancel</MudButton>
       <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="OnvalidSubmit">Create Ticket</MudButton>
    
    </EditForm>
    </div>  
    </div>
     

@code{
    private TicketCreateDTO Model { get;set; } =new();
    private void OnvalidSubmit()
    {
        TicketService.CreateTicket(Model);
        NavigationManager.NavigateTo("/SupportTicket");
    }
}