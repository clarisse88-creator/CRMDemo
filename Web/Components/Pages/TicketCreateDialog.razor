@using  Application.DTO
@using System.ComponentModel.DataAnnotations
@using Domain.Entities
@using Application.Services.Tickets
@using MudBlazor
@using MudBlazor.Services
@using Microsoft.AspNetCore.Components
@using Microsoft.EntityFrameworkCore.Metadata.Internal
@inject NavigationManager Navigation
@inject ITicketService TicketService
@inject ISnackbar Snackbar
@inject IDialogService DialogService


<MudDialog>
<DialogContent>
    <EditForm Model="Model" OnValidSubmit="onValidSubmit">
        <DataAnnotationsValidator />
        <MudGrid>
            <MudItem xs="12">
                <MudTextField Label="CustomerId" @bind-Value="Model.CustomerId" For="@(() => Model.CustomerId)" />
            </MudItem>
            <MudItem xs="12">
                <MudTextField Label="Subject" @bind-Value="Model.Subject" For="@(() => Model.Subject)" />
            </MudItem>
            <MudItem xs="12">
                <MudTextField Label="Description" @bind-Value="Model.Description" For="@(() => Model.Description)" />
            </MudItem>
            <MudItem xs="12">
                <MudTextField Label="Status" @bind-Value="Model.Status" For="@(() => Model.Status)" />
            </MudItem>
            <MudItem xs="12">
                <MudTextField Label="Priority" @bind-Value="Model.Priority" For="@(() => Model.Priority)" />
            </MudItem>
            <MudItem xs="12">
                <MudTextField Label="Type" @bind-Value="Model.Type" For="@(() => Model.Type)" />
            </MudItem>
            
            <MudItem xs="12" class="d-flex justify-content-end">
                <MudButton Variant="Variant.Filled" Color="Color.Primary" ButtonType="ButtonType.Submit">Add Campaign</MudButton>
            </MudItem>
        </MudGrid>

    </EditForm>
</DialogContent>
</MudDialog>

@code{
    [CascadingParameter] IMudDialogInstance DialogInstance { get; set; }

    private TicketCreateDTO Model {get;set;} = new ();
   


    private void onValidSubmit()
    {
        TicketService.CreateTicket(Model);
        Snackbar.Add("Ticket created successfully!", Severity.Success);
        DialogInstance.Close();
    }
    

}
